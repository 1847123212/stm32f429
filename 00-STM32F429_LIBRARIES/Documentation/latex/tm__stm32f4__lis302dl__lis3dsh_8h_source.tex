\hypertarget{tm__stm32f4__lis302dl__lis3dsh_8h_source}{}\subsection{tm\+\_\+stm32f4\+\_\+lis302dl\+\_\+lis3dsh.\+h}

\begin{DoxyCode}
00001 
00055 \textcolor{preprocessor}{#ifndef TM\_LIS302DL\_LIS3DSH\_H}
00056 \textcolor{preprocessor}{#define TM\_LIS302DL\_LIS3DSH\_H 100}
00057 
00068 \textcolor{preprocessor}{#include "stm32f4xx.h"}
00069 \textcolor{preprocessor}{#include "stm32f4xx\_rcc.h"}
00070 \textcolor{preprocessor}{#include "stm32f4xx\_gpio.h"}
00071 \textcolor{preprocessor}{#include "defines.h"}
00072 \textcolor{preprocessor}{#include "tm\_stm32f4\_spi.h"}
00073 
00074 \textcolor{comment}{/* SPI on STM32F4-Discovery board */}
00075 \textcolor{preprocessor}{#ifndef LIS302DL\_LIS3DSH\_SPI}
00076 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_SPI                SPI1}
00077 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_SPI\_PINSPACK       TM\_SPI\_PinsPack\_1}
00078 \textcolor{preprocessor}{#endif}
00079 
00080 \textcolor{comment}{/* CS pin on STM32F4-Discovery board */}
00081 \textcolor{preprocessor}{#ifndef LIS302DL\_LIS3DSH\_CS\_PIN}
00082 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_CS\_RCC             RCC\_AHB1Periph\_GPIOE}
00083 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_CS\_PORT            GPIOE}
00084 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_CS\_PIN             GPIO\_Pin\_3}
00085 \textcolor{preprocessor}{#endif}
00086 
00087 \textcolor{comment}{/* CS pin settings */}
00088 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_CS\_LOW             LIS302DL\_LIS3DSH\_CS\_PORT->BSRRH = LIS302DL\_LIS3DSH\_CS\_PIN}
00089 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_CS\_HIGH            LIS302DL\_LIS3DSH\_CS\_PORT->BSRRL = LIS302DL\_LIS3DSH\_CS\_PIN}
00090 
00091 \textcolor{comment}{/* Who I am values */}
00092 \textcolor{preprocessor}{#define LIS302DL\_ID                         0x3B}
00093 \textcolor{preprocessor}{#define LIS3DSH\_ID                          0x3F}
00094 
00095 \textcolor{comment}{/* Common registers */}
00096 \textcolor{preprocessor}{#define LIS302DL\_LIS3DSH\_REG\_WHO\_I\_AM       0x0F}
00097 
00098 \textcolor{comment}{/* ----------------------------------------- */}
00099 \textcolor{comment}{/* LIS3DSH registers */}
00100 \textcolor{comment}{/* ----------------------------------------- */}
00101 \textcolor{preprocessor}{#define LIS3DSH\_WHO\_AM\_I\_ADDR               0x0F}
00102 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG4\_ADDR              0x20}
00103 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG1\_ADDR              0x21}
00104 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG2\_ADDR              0x22}
00105 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG3\_ADDR              0x23}
00106 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG5\_ADDR              0x24}
00107 \textcolor{preprocessor}{#define LIS3DSH\_CTRL\_REG6\_ADDR              0x25}
00108 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_X\_L\_ADDR                0x28}
00109 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_X\_H\_ADDR                0x29}
00110 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_Y\_L\_ADDR                0x2A}
00111 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_Y\_H\_ADDR                0x2B}
00112 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_Z\_L\_ADDR                0x2C}
00113 \textcolor{preprocessor}{#define LIS3DSH\_OUT\_Z\_H\_ADDR                0x2D}
00114 
00115 \textcolor{preprocessor}{#define LIS3DSH\_SENSITIVITY\_0\_06G            0.06  }\textcolor{comment}{/* 0.06 mg/digit*/}\textcolor{preprocessor}{}
00116 \textcolor{preprocessor}{#define LIS3DSH\_SENSITIVITY\_0\_12G            0.12  }\textcolor{comment}{/* 0.12 mg/digit*/}\textcolor{preprocessor}{}
00117 \textcolor{preprocessor}{#define LIS3DSH\_SENSITIVITY\_0\_18G            0.18  }\textcolor{comment}{/* 0.18 mg/digit*/}\textcolor{preprocessor}{}
00118 \textcolor{preprocessor}{#define LIS3DSH\_SENSITIVITY\_0\_24G            0.24  }\textcolor{comment}{/* 0.24 mg/digit*/}\textcolor{preprocessor}{}
00119 \textcolor{preprocessor}{#define LIS3DSH\_SENSITIVITY\_0\_73G            0.73  }\textcolor{comment}{/* 0.73 mg/digit*/}\textcolor{preprocessor}{}
00120 
00121 \textcolor{preprocessor}{#define LIS3DSH\_DATARATE\_100                ((uint8\_t)0x60)}
00122 
00123 \textcolor{preprocessor}{#define LIS3DSH\_FULLSCALE\_2                 ((uint8\_t)0x00)  }\textcolor{comment}{/* 2 g  */}\textcolor{preprocessor}{}
00124 \textcolor{preprocessor}{#define LIS3DSH\_FULLSCALE\_4                 ((uint8\_t)0x08)  }\textcolor{comment}{/* 4 g  */}\textcolor{preprocessor}{}
00125 \textcolor{preprocessor}{#define LIS3DSH\_FULLSCALE\_6                 ((uint8\_t)0x10)  }\textcolor{comment}{/* 6 g  */}\textcolor{preprocessor}{}
00126 \textcolor{preprocessor}{#define LIS3DSH\_FULLSCALE\_8                 ((uint8\_t)0x18)  }\textcolor{comment}{/* 8 g  */}\textcolor{preprocessor}{}
00127 \textcolor{preprocessor}{#define LIS3DSH\_FULLSCALE\_16                ((uint8\_t)0x20)  }\textcolor{comment}{/* 16 g */}\textcolor{preprocessor}{}
00128 \textcolor{preprocessor}{#define LIS3DSH\_\_FULLSCALE\_SELECTION        ((uint8\_t)0x38)}
00129 
00130 \textcolor{preprocessor}{#define LIS3DSH\_FILTER\_BW\_800               ((uint8\_t)0x00)  }\textcolor{comment}{/* 800 Hz */}\textcolor{preprocessor}{}
00131 \textcolor{preprocessor}{#define LIS3DSH\_FILTER\_BW\_400               ((uint8\_t)0x40)//((uint8\_t)0x08) }\textcolor{comment}{/* 400 Hz  */}\textcolor{preprocessor}{}
00132 \textcolor{preprocessor}{#define LIS3DSH\_FILTER\_BW\_200               ((uint8\_t)0x80)//((uint8\_t)0x10)  }\textcolor{comment}{/* 200 Hz */}\textcolor{preprocessor}{}
00133 \textcolor{preprocessor}{#define LIS3DSH\_FILTER\_BW\_50                ((uint8\_t)(0x80 | 0x40))//((uint8\_t)0x18)  }\textcolor{comment}{/* 50 Hz  */}\textcolor{preprocessor}{}
00134 \textcolor{preprocessor}{#define LIS3DSH\_SELFTEST\_NORMAL             ((uint8\_t)0x00)}
00135 \textcolor{preprocessor}{#define LIS3DSH\_XYZ\_ENABLE                  ((uint8\_t)0x07)}
00136 \textcolor{preprocessor}{#define LIS3DSH\_SERIALINTERFACE\_4WIRE       ((uint8\_t)0x00)}
00137 \textcolor{preprocessor}{#define LIS3DSH\_SM\_ENABLE                   ((uint8\_t)0x01)}
00138 \textcolor{preprocessor}{#define LIS3DSH\_SM\_DISABLE                  ((uint8\_t)0x00)}
00139 
00140 \textcolor{comment}{/* ----------------------------------------- */}
00141 \textcolor{comment}{/* LIS302DL registers                        */}
00142 \textcolor{comment}{/* ----------------------------------------- */}
00143 \textcolor{preprocessor}{#define LIS302DL\_CTRL\_REG1\_ADDR                         0x20}
00144 \textcolor{preprocessor}{#define LIS302DL\_CTRL\_REG2\_ADDR                         0x21}
00145 \textcolor{preprocessor}{#define LIS302DL\_CTRL\_REG3\_ADDR                         0x22}
00146 \textcolor{preprocessor}{#define LIS302DL\_OUT\_X\_ADDR                             0x29}
00147 \textcolor{preprocessor}{#define LIS302DL\_OUT\_Y\_ADDR                             0x2B}
00148 \textcolor{preprocessor}{#define LIS302DL\_OUT\_Z\_ADDR                             0x2D}
00149 
00150 \textcolor{preprocessor}{#define LIS302DL\_SENSITIVITY\_2\_3G                       18  }\textcolor{comment}{/* 18 mg/digit*/}\textcolor{preprocessor}{}
00151 \textcolor{preprocessor}{#define LIS302DL\_SENSITIVITY\_9\_2G                       72  }\textcolor{comment}{/* 72 mg/digit*/}\textcolor{preprocessor}{}
00152 
00153 \textcolor{preprocessor}{#define LIS302DL\_DATARATE\_100                           ((uint8\_t)0x00)}
00154 \textcolor{preprocessor}{#define LIS302DL\_DATARATE\_400                           ((uint8\_t)0x80)}
00155 
00156 \textcolor{preprocessor}{#define LIS302DL\_LOWPOWERMODE\_ACTIVE                    ((uint8\_t)0x40)}
00157 \textcolor{preprocessor}{#define LIS302DL\_FULLSCALE\_2\_3                          ((uint8\_t)0x00)}
00158 \textcolor{preprocessor}{#define LIS302DL\_FULLSCALE\_9\_2                          ((uint8\_t)0x20)}
00159 \textcolor{preprocessor}{#define LIS302DL\_SELFTEST\_NORMAL                        ((uint8\_t)0x00)}
00160 \textcolor{preprocessor}{#define LIS302DL\_XYZ\_ENABLE                             ((uint8\_t)0x07)}
00161 \textcolor{preprocessor}{#define LIS302DL\_SERIALINTERFACE\_4WIRE                  ((uint8\_t)0x00)}
00162 \textcolor{preprocessor}{#define LIS302DL\_BOOT\_NORMALMODE                        ((uint8\_t)0x00)}
00163 \textcolor{preprocessor}{#define LIS302DL\_BOOT\_REBOOTMEMORY                      ((uint8\_t)0x40)}
00164 \textcolor{preprocessor}{#define LIS302DL\_FILTEREDDATASELECTION\_OUTPUTREGISTER   ((uint8\_t)0x20)}
00165 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTERINTERRUPT\_OFF            ((uint8\_t)0x00)}
00166 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTERINTERRUPT\_1              ((uint8\_t)0x04)}
00167 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTERINTERRUPT\_2              ((uint8\_t)0x08)}
00168 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTERINTERRUPT\_1\_2            ((uint8\_t)0x0C)}
00169 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTER\_LEVEL\_0                 ((uint8\_t)0x00)}
00170 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTER\_LEVEL\_1                 ((uint8\_t)0x01)}
00171 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTER\_LEVEL\_2                 ((uint8\_t)0x02)}
00172 \textcolor{preprocessor}{#define LIS302DL\_HIGHPASSFILTER\_LEVEL\_3                 ((uint8\_t)0x03)}
00173 
00185 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{
00186     TM\_LIS302DL\_LIS3DSH\_Device\_Error,
00187     TM\_LIS302DL\_LIS3DSH\_Device\_LIS302DL,
00188     TM\_LIS302DL\_LIS3DSH\_Device\_LIS3DSH
00189 \} TM\_LIS302DL\_LIS3DSH\_Device\_t;
00190 
00211 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{
00212     \textcolor{comment}{/* LIS3DSH */}
00213     TM\_LIS3DSH\_Sensitivity\_2G,
00214     TM\_LIS3DSH\_Sensitivity\_4G,
00215     TM\_LIS3DSH\_Sensitivity\_6G,
00216     TM\_LIS3DSH\_Sensitivity\_8G,
00217     TM\_LIS3DSH\_Sensitivity\_16G,
00218     \textcolor{comment}{/* LIS302DL */}
00219     TM\_LIS302DL\_Sensitivity\_2\_3G,
00220     TM\_LIS302DL\_Sensitivity\_9\_2G
00221 \} TM\_LIS302DL\_LIS3DSH\_Sensitivity\_t;
00222 
00245 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{
00246     \textcolor{comment}{/* LIS3DSH */}
00247     TM\_LIS3DSH\_Filter\_800Hz,
00248     TM\_LIS3DSH\_Filter\_400Hz,
00249     TM\_LIS3DSH\_Filter\_200Hz,
00250     TM\_LIS3DSH\_Filter\_50Hz,
00251     \textcolor{comment}{/* LIS302DL */}
00252     TM\_LIS302DL\_Filter\_2Hz,
00253     TM\_LIS302DL\_Filter\_1Hz,
00254     TM\_LIS302DL\_Filter\_500mHz,
00255     TM\_LIS302DL\_Filter\_250mHz
00256 \} TM\_LIS302DL\_LIS3DSH\_Filter\_t;
00257 
\hypertarget{tm__stm32f4__lis302dl__lis3dsh_8h_source_l00269}{}\hyperlink{struct_t_m___l_i_s302_d_l___l_i_s3_d_s_h__t}{00269} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{
00270     int16\_t X;
00271     int16\_t Y;
00272     int16\_t Z;
00273 \} \hyperlink{struct_t_m___l_i_s302_d_l___l_i_s3_d_s_h__t}{TM\_LIS302DL\_LIS3DSH\_t};
00274 
00280 \textcolor{keyword}{extern} TM\_LIS302DL\_LIS3DSH\_Device\_t TM\_LIS302DL\_LIS3DSH\_Detect(\textcolor{keywordtype}{void});
00281 
00293 \textcolor{keyword}{extern} TM\_LIS302DL\_LIS3DSH\_Device\_t TM\_LIS302DL\_LIS3DSH\_Init(TM\_LIS302DL\_LIS3DSH\_Sensitivity\_t Sensitivity,
       TM\_LIS302DL\_LIS3DSH\_Filter\_t Filter);
00294 
00304 \textcolor{keyword}{extern} TM\_LIS302DL\_LIS3DSH\_Device\_t TM\_LIS302DL\_LIS3DSH\_ReadAxes(
      \hyperlink{struct_t_m___l_i_s302_d_l___l_i_s3_d_s_h__t}{TM\_LIS302DL\_LIS3DSH\_t}* Axes\_Data);
00305 
00306 \textcolor{preprocessor}{#endif}
00307 
00308 
\end{DoxyCode}
