\hypertarget{tm__stm32f4__ds1307_8h_source}{}\subsection{tm\+\_\+stm32f4\+\_\+ds1307.\+h}

\begin{DoxyCode}
00001 
00053 \textcolor{preprocessor}{#ifndef TM\_DS1307\_H}
00054 \textcolor{preprocessor}{#define TM\_DS1307\_H 120}
00055 
00067 \textcolor{preprocessor}{#include "stm32f4xx.h"}
00068 \textcolor{preprocessor}{#include "tm\_stm32f4\_i2c.h"}
00069 \textcolor{preprocessor}{#include "defines.h"}
00070 
00071 \textcolor{comment}{/* I2C settings for I2C library */}
00072 \textcolor{preprocessor}{#ifndef DS1307\_I2C}
00073 \textcolor{preprocessor}{#define DS1307\_I2C                  I2C1}
00074 \textcolor{preprocessor}{#define DS1307\_I2C\_PINSPACK         TM\_I2C\_PinsPack\_1}
00075 \textcolor{preprocessor}{#endif}
00076 
00077 \textcolor{comment}{/* DS1307 I2C clock */}
00078 \textcolor{preprocessor}{#ifndef DS1307\_I2C\_CLOCK}
00079 \textcolor{preprocessor}{#define DS1307\_I2C\_CLOCK            100000}
00080 \textcolor{preprocessor}{#endif}
00081 
00082 \textcolor{comment}{/* I2C slave address for DS1307 */}
00083 \textcolor{preprocessor}{#define DS1307\_I2C\_ADDR             0xD0}
00084 
00085 \textcolor{comment}{/* Registers location */}
00086 \textcolor{preprocessor}{#define DS1307\_SECONDS              0x00}
00087 \textcolor{preprocessor}{#define DS1307\_MINUTES              0x01}
00088 \textcolor{preprocessor}{#define DS1307\_HOURS                0x02}
00089 \textcolor{preprocessor}{#define DS1307\_DAY                  0x03}
00090 \textcolor{preprocessor}{#define DS1307\_DATE                 0x04}
00091 \textcolor{preprocessor}{#define DS1307\_MONTH                0x05}
00092 \textcolor{preprocessor}{#define DS1307\_YEAR                 0x06}
00093 \textcolor{preprocessor}{#define DS1307\_CONTROL              0x07}
00094 
00095 \textcolor{comment}{/* Bits in control register */}
00096 \textcolor{preprocessor}{#define DS1307\_CONTROL\_OUT          7}
00097 \textcolor{preprocessor}{#define DS1307\_CONTROL\_SQWE         4}
00098 \textcolor{preprocessor}{#define DS1307\_CONTROL\_RS1          1}
00099 \textcolor{preprocessor}{#define DS1307\_CONTROL\_RS0          0}
00100 
00112 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{
00113     TM\_DS1307\_Result\_Ok = 0,
00114     TM\_DS1307\_Result\_Error,
00115     TM\_DS1307\_Result\_DeviceNotConnected
00116 \} TM\_DS1307\_Result\_t;
00117 
\hypertarget{tm__stm32f4__ds1307_8h_source_l00137}{}\hyperlink{struct_t_m___d_s1307___time__t}{00137} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{
00138     uint8\_t seconds;    \textcolor{comment}{//Seconds,          00-59}
00139     uint8\_t minutes;    \textcolor{comment}{//Minutes,          00-59}
00140     uint8\_t hours;      \textcolor{comment}{//Hours,            00-23}
00141     uint8\_t day;        \textcolor{comment}{//Day in a week,    1-7}
00142     uint8\_t date;       \textcolor{comment}{//Day in a month    1-31}
00143     uint8\_t month;      \textcolor{comment}{//Month,            1-12}
00144     uint8\_t year;       \textcolor{comment}{//Year              00-99}
00145 \} \hyperlink{struct_t_m___d_s1307___time__t}{TM\_DS1307\_Time\_t};
00146 
00163 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{
00164     TM\_DS1307\_OutputFrequency\_1Hz = 0,
00165     TM\_DS1307\_OutputFrequency\_4096Hz,
00166     TM\_DS1307\_OutputFrequency\_8192Hz,
00167     TM\_DS1307\_OutputFrequency\_32768Hz,
00168     TM\_DS1307\_OutputFrequency\_High,
00169     TM\_DS1307\_OutputFrequency\_Low
00170 \} TM\_DS1307\_OutputFrequency\_t;
00171 
00179 \textcolor{keyword}{extern} TM\_DS1307\_Result\_t TM\_DS1307\_Init(\textcolor{keywordtype}{void});
00180 
00189 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetSeconds(\textcolor{keywordtype}{void});
00190 
00199 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetMinutes(\textcolor{keywordtype}{void});
00200 
00209 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetHours(\textcolor{keywordtype}{void});
00210 
00219 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetDay(\textcolor{keywordtype}{void});
00220 
00229 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetDate(\textcolor{keywordtype}{void});
00230 
00239 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetMonth(\textcolor{keywordtype}{void});
00240 
00249 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_GetYear(\textcolor{keywordtype}{void});
00250 
00251 
00261 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetSeconds(uint8\_t seconds);
00262 
00272 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetMinutes(uint8\_t minutes);
00273 
00283 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetHours(uint8\_t hours);
00284 
00294 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetDay(uint8\_t day);
00295 
00305 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetDate(uint8\_t date);
00306 
00316 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetMonth(uint8\_t month);
00317 
00327 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetYear(uint8\_t year);
00328 
00338 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_GetDateTime(\hyperlink{struct_t_m___d_s1307___time__t}{TM\_DS1307\_Time\_t}* time);
00339 
00349 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_SetDateTime(\hyperlink{struct_t_m___d_s1307___time__t}{TM\_DS1307\_Time\_t}* time);
00350 
00366 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_EnableOutputPin(TM\_DS1307\_OutputFrequency\_t frequency);
00367 
00376 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} TM\_DS1307\_DisableOutputPin(\textcolor{keywordtype}{void});
00377 
00378 
00388 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_Bcd2Bin(uint8\_t bcd);
00389 
00399 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_Bin2Bcd(uint8\_t bin);
00400 
00414 \textcolor{keyword}{extern} uint8\_t TM\_DS1307\_CheckMinMax(uint8\_t val, uint8\_t min, uint8\_t max);
00415 
00416 \textcolor{preprocessor}{#endif}
00417 
\end{DoxyCode}
